webpackJsonp([5],{5:function(t,e,i){"use strict";function n(t){c.a.call(this),this._hooks={},this._loading=!1,this._pageCounter=0,this._throttle=0,this._trigger=t.trigger,this._urlBuilder=null,"number"==typeof t.throttle&&(this._throttle=t.throttle),"function"==typeof t.url?this._urlBuilder=t.url:this._urlBuilder=o(t.url),this.el=t.el,this.isEnabled=!1,this.isPaused=!1}function o(t){return function(){return t}}function r(t){this.emit("loadError",Object(s.k)("loadError",this,{data:t.event,originalRequest:t.request})),this._loading=!1}function l(t){this.emit("loadComplete",Object(s.k)("loadComplete",this,{data:t.event,originalRequest:t.request})),this._loading=!1}var s=i(0),a=i(1),c=i.n(a);n.prototype=Object(s.D)(c.a.prototype,{_bind:function(){this._throttle>0?this._hooks.onScroll=Object(s.R)(this.update,this._throttle,this):this._hooks.onScroll=this.update.bind(this),Object(s.b)(this.el,"scroll",this._hooks.onScroll)},_loadUrl:function(){var t=this._urlBuilder(++this._pageCounter);this._loading=!0,this.emit("loading",Object(s.k)("loading",this,{url:t})),Object(s.e)({url:t}).then(l.bind(this),r.bind(this))},_unbind:function(){Object(s.P)(this.el,"scroll",this._hooks.onScroll),this._hooks.onScroll=null},destroy:function(){this.disable(),this.el=null,this.emit("destroy",Object(s.k)("destroy",this)),this.removeAllListeners()},disable:function(){this.isEnabled&&(this.isEnabled=!1,this._unbind(),this.emit("disable",Object(s.k)("disable",this)))},enable:function(){this.isEnabled||(this.isEnabled=!0,this._bind(),this.emit("enable",Object(s.k)("enable",this)))},pause:function(){this.isPaused=!0,this.emit("pause",Object(s.k)("pause",this))},resume:function(){this.isPaused=!1,this.emit("resume",Object(s.k)("resume",this))},update:function(){if(!this._loading&&!this.isPaused&&this.isEnabled){var t=Object(s.z)(this.el);this._trigger(t)&&this._loadUrl()}}}),e.a=n},51:function(t,e,i){"use strict";function n(t,e){for(var i=-1,n=e.length;++i<n;)t.appendChild(e[i])}function o(){Object(p.P)(document.getElementById(y),"click",c)}function r(){throw o(),new Error("Error trying to load more articles")}function l(t){var e=document.createDocumentFragment(),i=Object(p.d)(e),o=document.getElementById(E);o=o.previousElementSibling.querySelector(".c-card-section ul"),i(t),n(o,e.querySelectorAll(".c-card-list__item"))}function s(t){var e=t.request.responseText,i=null;try{i=JSON.parse(e)}catch(t){throw console.error("Error trying to parse response JSON"),t}i.data.template&&l(i.data.template),i.data.local_storage&&i.data.local_storage.forEach(function(t){Object(O.d)(t.key,t.value)}),i.data.stop?o():Object(p.N)(document.getElementById(y),j),k=!1}function a(t,e,i,n){var o="/xhr/magazine/articles?year="+Number(e)+"&month="+Number(t)+"&page="+Number(i);return null!==n&&!1!==n?o+="&exclude_uid="+n:S&&(o+="&shift=-1"),o}function c(){if(!k){k=!0,Object(p.a)(document.getElementById(y),j);var t=Object(O.b)("magazine_month"),e=Object(O.b)("magazine_year"),i=Object(O.b)("magazine_cover_story_uid");Object(p.e)({url:a(t,e,++v,i)}).then(s,r)}}function u(t){return Object(p.T)(Object(O.b)("infinite_url"),{page:t})}function d(){P.destroy(),Object(p.P)(window,"resize",I),P=null,I=null}function h(t,e){for(var i=-1,n=e.length;++i<n;)t.appendChild(e[i])}function b(t){var e=document.createDocumentFragment(),i=Object(p.d)(e),n=document.getElementById(q);n=n.previousElementSibling.querySelector(".c-card-section ul"),i(t),h(n,e.querySelectorAll(".c-card-list__item"))}function m(t){f("Error trying to load url in infinite scroll",t)}function g(){C=document.body.scrollHeight-window.innerHeight}function f(t,e){throw d(),new Error(t,e)}function _(t){var e=t.originalRequest.responseText,i=null;try{i=JSON.parse(e)}catch(t){f("Error trying to parse response JSON",t)}i.data.template&&b(i.data.template),i.stop&&d(),g()}Object.defineProperty(e,"__esModule",{value:!0});var p=i(0),O=i(6),j="global__hidden",y="btnMagazineMoreArticles",E="moreArticlesHook",v=1,k=!1,S=!1,w=i(5),q="infiniteScrollHook",B=1e3,N=300,z=300,P=null,C=0,I=null;!function(){var t=document.getElementById(y);t&&(Object(p.b)(t,"click",c),Object(p.N)(t.parentNode,j),S=null!==Object(O.b)("magazine_cover_story_uid"))}(),function(){P=new w.a({el:window,throttle:N,trigger:function(t){return t>=C-B},url:function(t){return location.origin+u(t+1)}}),P.on("loadError",m),P.on("loadComplete",_),g(),Object(p.K)(g),I=Object(p.R)(g,z),Object(p.b)(window,"resize",I),P.enable()}()}},[51]);
//# sourceMappingURL=magazine.min.js.map